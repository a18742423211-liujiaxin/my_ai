#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
PyTorch åŸºç¡€æ“ä½œç¤ºä¾‹
===================

è¿™ä¸ªæ–‡ä»¶å°†æ•™æ‚¨PyTorchçš„æœ€åŸºç¡€æ“ä½œï¼š
1. ä»€ä¹ˆæ˜¯å¼ é‡(Tensor)
2. å¦‚ä½•åˆ›å»ºå¼ é‡
3. å¼ é‡çš„åŸºæœ¬è¿ç®—
4. å¼ é‡å½¢çŠ¶çš„å˜æ¢

é€‚åˆå®Œå…¨æ²¡æœ‰PyTorchç»éªŒçš„æ–°æ‰‹ï¼
"""

import torch
import numpy as np

def main():
    print("ğŸš€ æ¬¢è¿æ¥åˆ°PyTorchåŸºç¡€æ“ä½œå­¦ä¹ ï¼")
    print("=" * 50)
    
    # ========================================
    # ç¬¬1éƒ¨åˆ†ï¼šä»€ä¹ˆæ˜¯å¼ é‡ï¼Ÿ
    # ========================================
    print("\nğŸ“š ç¬¬1éƒ¨åˆ†ï¼šè®¤è¯†å¼ é‡(Tensor)")
    print("-" * 30)
    
    # å¼ é‡å°±åƒæ˜¯ä¸€ä¸ªå¯ä»¥å­˜å‚¨æ•°å­—çš„å®¹å™¨
    # å¯ä»¥æ˜¯ä¸€ä¸ªæ•°å­—(æ ‡é‡)ã€ä¸€è¡Œæ•°å­—(å‘é‡)ã€ä¸€ä¸ªè¡¨æ ¼(çŸ©é˜µ)ç­‰ç­‰
    
    # åˆ›å»ºä¸€ä¸ªç®€å•çš„å¼ é‡
    simple_tensor = torch.tensor([1, 2, 3, 4, 5])
    print(f"ç®€å•å¼ é‡: {simple_tensor}")
    print(f"å¼ é‡çš„å½¢çŠ¶: {simple_tensor.shape}")  # å½¢çŠ¶å‘Šè¯‰æˆ‘ä»¬è¿™ä¸ªå¼ é‡æœ‰å¤šå¤§
    print(f"å¼ é‡çš„ç±»å‹: {simple_tensor.dtype}")  # ç±»å‹å‘Šè¯‰æˆ‘ä»¬å­˜å‚¨çš„æ˜¯ä»€ä¹ˆæ•°æ®
    
    # ========================================
    # ç¬¬2éƒ¨åˆ†ï¼šåˆ›å»ºä¸åŒç±»å‹çš„å¼ é‡
    # ========================================
    print("\nğŸ“š ç¬¬2éƒ¨åˆ†ï¼šåˆ›å»ºå„ç§å¼ é‡")
    print("-" * 30)
    
    # 1. åˆ›å»ºå…¨é›¶å¼ é‡
    zeros = torch.zeros(3, 4)  # 3è¡Œ4åˆ—çš„è¡¨æ ¼ï¼Œé‡Œé¢éƒ½æ˜¯0
    print(f"å…¨é›¶å¼ é‡ (3x4):\n{zeros}")
    
    # 2. åˆ›å»ºå…¨1å¼ é‡
    ones = torch.ones(2, 3)  # 2è¡Œ3åˆ—çš„è¡¨æ ¼ï¼Œé‡Œé¢éƒ½æ˜¯1
    print(f"\nå…¨1å¼ é‡ (2x3):\n{ones}")
    
    # 3. åˆ›å»ºéšæœºå¼ é‡
    random_tensor = torch.rand(2, 2)  # 2x2çš„è¡¨æ ¼ï¼Œé‡Œé¢æ˜¯0åˆ°1ä¹‹é—´çš„éšæœºæ•°
    print(f"\néšæœºå¼ é‡ (2x2):\n{random_tensor}")
    
    # 4. ä»Pythonåˆ—è¡¨åˆ›å»ºå¼ é‡
    from_list = torch.tensor([[1, 2], [3, 4], [5, 6]])
    print(f"\nä»åˆ—è¡¨åˆ›å»ºçš„å¼ é‡:\n{from_list}")
    
    # ========================================
    # ç¬¬3éƒ¨åˆ†ï¼šå¼ é‡çš„åŸºæœ¬è¿ç®—
    # ========================================
    print("\nğŸ“š ç¬¬3éƒ¨åˆ†ï¼šå¼ é‡çš„åŸºæœ¬è¿ç®—")
    print("-" * 30)
    
    # åˆ›å»ºä¸¤ä¸ªç®€å•çš„å¼ é‡æ¥åšè¿ç®—
    a = torch.tensor([1, 2, 3])
    b = torch.tensor([4, 5, 6])
    
    print(f"å¼ é‡ a: {a}")
    print(f"å¼ é‡ b: {b}")
    
    # åŠ æ³•è¿ç®—
    add_result = a + b
    print(f"\na + b = {add_result}")
    
    # å‡æ³•è¿ç®—
    sub_result = a - b
    print(f"a - b = {sub_result}")
    
    # ä¹˜æ³•è¿ç®—ï¼ˆé€ä¸ªå…ƒç´ ç›¸ä¹˜ï¼‰
    mul_result = a * b
    print(f"a * b = {mul_result}")
    
    # é™¤æ³•è¿ç®—
    div_result = a / b
    print(f"a / b = {div_result}")
    
    # å¹³æ–¹è¿ç®—
    square_result = a ** 2
    print(f"açš„å¹³æ–¹ = {square_result}")
    
    # ========================================
    # ç¬¬4éƒ¨åˆ†ï¼šå¼ é‡çš„å½¢çŠ¶æ“ä½œ
    # ========================================
    print("\nğŸ“š ç¬¬4éƒ¨åˆ†ï¼šæ”¹å˜å¼ é‡çš„å½¢çŠ¶")
    print("-" * 30)
    
    # åˆ›å»ºä¸€ä¸ª1ç»´å¼ é‡
    original = torch.tensor([1, 2, 3, 4, 5, 6])
    print(f"åŸå§‹å¼ é‡: {original}")
    print(f"åŸå§‹å½¢çŠ¶: {original.shape}")
    
    # é‡æ–°æ•´ç†æˆ2è¡Œ3åˆ—çš„è¡¨æ ¼
    reshaped = original.reshape(2, 3)
    print(f"\né‡æ–°æ•´ç†æˆ2x3:\n{reshaped}")
    
    # é‡æ–°æ•´ç†æˆ3è¡Œ2åˆ—çš„è¡¨æ ¼
    reshaped2 = original.reshape(3, 2)
    print(f"\né‡æ–°æ•´ç†æˆ3x2:\n{reshaped2}")
    
    # è½¬ç½®ï¼ˆè¡Œåˆ—äº’æ¢ï¼‰
    transposed = reshaped.T
    print(f"\nè½¬ç½®å:\n{transposed}")
    
    # ========================================
    # ç¬¬5éƒ¨åˆ†ï¼šå¼ é‡çš„ç»Ÿè®¡ä¿¡æ¯
    # ========================================
    print("\nğŸ“š ç¬¬5éƒ¨åˆ†ï¼šè®¡ç®—å¼ é‡çš„ç»Ÿè®¡ä¿¡æ¯")
    print("-" * 30)
    
    # åˆ›å»ºä¸€ä¸ªç¤ºä¾‹å¼ é‡
    data = torch.tensor([[1.0, 2.0, 3.0], 
                        [4.0, 5.0, 6.0]])
    print(f"æ•°æ®å¼ é‡:\n{data}")
    
    # è®¡ç®—å„ç§ç»Ÿè®¡å€¼
    print(f"\næœ€å¤§å€¼: {torch.max(data)}")
    print(f"æœ€å°å€¼: {torch.min(data)}")
    print(f"å¹³å‡å€¼: {torch.mean(data)}")
    print(f"æ€»å’Œ: {torch.sum(data)}")
    print(f"æ ‡å‡†å·®: {torch.std(data)}")
    
    # ========================================
    # ç¬¬6éƒ¨åˆ†ï¼šä¸NumPyçš„è½¬æ¢
    # ========================================
    print("\nğŸ“š ç¬¬6éƒ¨åˆ†ï¼šPyTorchå¼ é‡ä¸NumPyæ•°ç»„çš„è½¬æ¢")
    print("-" * 30)
    
    # PyTorchå¼ é‡è½¬æ¢ä¸ºNumPyæ•°ç»„
    tensor = torch.tensor([1, 2, 3, 4, 5])
    numpy_array = tensor.numpy()
    print(f"PyTorchå¼ é‡: {tensor}")
    print(f"è½¬æ¢ä¸ºNumPyæ•°ç»„: {numpy_array}")
    print(f"NumPyæ•°ç»„ç±»å‹: {type(numpy_array)}")
    
    # NumPyæ•°ç»„è½¬æ¢ä¸ºPyTorchå¼ é‡
    numpy_data = np.array([6, 7, 8, 9, 10])
    tensor_from_numpy = torch.from_numpy(numpy_data)
    print(f"\nNumPyæ•°ç»„: {numpy_data}")
    print(f"è½¬æ¢ä¸ºPyTorchå¼ é‡: {tensor_from_numpy}")
    print(f"å¼ é‡ç±»å‹: {type(tensor_from_numpy)}")
    
    # ========================================
    # ç»ƒä¹ æ—¶é—´ï¼
    # ========================================
    print("\nğŸ¯ ç»ƒä¹ æ—¶é—´ï¼")
    print("-" * 30)
    print("å°è¯•ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶ä¸­çš„ä»£ç ï¼š")
    print("1. åˆ›å»ºä¸€ä¸ª4x4çš„éšæœºå¼ é‡")
    print("2. è®¡ç®—è¿™ä¸ªå¼ é‡çš„å¹³å‡å€¼")
    print("3. å°†å®ƒé‡æ–°æ•´ç†æˆ2x8çš„å½¢çŠ¶")
    print("4. è¯•è¯•çœ‹å…¶ä»–çš„æ•°å­¦è¿ç®—")
    
    print("\nâœ… æ­å–œï¼æ‚¨å·²ç»å®Œæˆäº†PyTorchåŸºç¡€æ“ä½œçš„å­¦ä¹ ï¼")
    print("ğŸ’¡ ä¸‹ä¸€æ­¥ï¼šè¿è¡Œ 02_simple_linear_regression.py å­¦ä¹ ç®€å•çš„æœºå™¨å­¦ä¹ ")

if __name__ == "__main__":
    # æ£€æŸ¥PyTorchæ˜¯å¦æ­£ç¡®å®‰è£…
    try:
        import torch
        print(f"âœ… PyTorchç‰ˆæœ¬: {torch.__version__}")
        main()
    except ImportError:
        print("âŒ PyTorchæœªå®‰è£…ï¼è¯·å…ˆè¿è¡Œ: pip install torch") 